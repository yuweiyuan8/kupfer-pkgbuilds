_mode=cross
_nodeps=true
pkgname=initsquared
pkgver=0.1
pkgrel=1
_arches=specific
arch=(any)
license=(GPL-3.0-or-later)
depends=(
    mkinitcpio-kupfer-hooks
)
install=initsquared.install

pkgdesc="Init shim hook to bootstrap a secondary initramfs"

source=(
    initsquared-hook
    initsquared-install
    initsquared.preset
    mkinitcpio-initsquared.conf
    initsquared.install
)
sha256sums=(
    59573be77de402c2b71236d707223e0dcfd48dc947c7fa855f0f47f3bb745f7e
    d5f43bf430b1dc7f27f31c1c6c019534d1d8455ccd351494fb1d390d9362cd41
    f827b705d358d9300934bd551e64ee1f6073ea54da9252001800bb9873abdc98
    7d1b7e0b41237259b265b2f86869ca2ba63f91717fd90a2c79ab58956f5849c3
    0c81a939e7fa4c94bca2a1a2951e4bef352e88fb15375b1c4026bcb3b2027055
)

package() {
    install -Dm644 "$srcdir"/initsquared-hook "$pkgdir"/usr/lib/initcpio/hooks/initsquared
    install -Dm644 "$srcdir"/initsquared-install "$pkgdir"/usr/lib/initcpio/install/initsquared
    install -Dm644 "$srcdir"/initsquared.preset "$pkgdir"/etc/mkinitcpio.d/initsquared.preset
    install -Dm644 "$srcdir"/mkinitcpio-initsquared.conf "$pkgdir"/etc/mkinitcpio-initsquared.conf
}

